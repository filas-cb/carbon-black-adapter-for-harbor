/*
 * Copyright 2021 VMware, Inc.
 * SPDX-License-Identifier: Apache-2.0
 */
 
package harbor

import (
	"testing"
)

func TestToHarborSeverity(t *testing.T) {
	harborSev := []Severity{CRITICAL, HIGH, MEDIUM, LOW, NEGLIGIBLE, UNKNOWN}
	var harborVul []Severity
	vul := [6]string{"critical", "high", "medium", "low", "negligible", "unknown"}
	for _, value := range vul {
		harborVulItem := ToHarborSeverity(value)
		harborVul = append(harborVul, harborVulItem)
	}

	for i, value := range harborVul {
		if harborSev[i] != value {
			t.Errorf("Severity conversion is not working as expected")
		}
	}
}

func TestMaxSeverity(t *testing.T) {
	dummyMaxSeverity := HIGH
	dummyMinSeverity := UNKNOWN

	resultMaxSeverity := MaxSeverity(dummyMaxSeverity, dummyMinSeverity)
	if resultMaxSeverity != HIGH {
		t.Errorf("Problem in finding Max severity")
	}
}
